# Malware Scanner üõ°Ô∏è

![made-with-python][made-with-python]
![Python Versions][pyversion-button]
![License](https://img.shields.io/badge/License-MIT-blue.svg)

A comprehensive malware detection tool that performs hash-based file scanning with advanced logging capabilities. Perfect for incident response, system monitoring, and security auditing.

## ‚ú® Features

### Core Scanning Capabilities
- **Hash-based Detection**: Compares file SHA256 hashes against known malware signatures
- **Recursive Directory Scanning**: Scans directories and all subdirectories
- **Multi-threaded Processing**: Parallel scanning for improved performance
- **Configurable File Extensions**: Define specific file types to scan
- **Directory Exclusions**: Skip system directories and virtual environments
- **File Size Filtering**: Configurable file size limits

### Enhanced Logging System üìä
- **Multiple Output Formats**: JSON, CSV, structured text, and table formats
- **Dual Logging**: Creates both machine-readable JSON and human-readable logs
- **SIEM Integration**: Easy integration with Splunk, ELK Stack, and other SIEM tools
- **Comprehensive Metadata**: Includes timestamps, system info, file details, and scan IDs

### System Information Collection
- **Host Details**: Hostname, OS version, IP address
- **File Metadata**: Creation time, modification time, file type
- **Scan Tracking**: Unique scan IDs for correlation and tracking

## üöÄ Quick Start

### Prerequisites
```bash
pip install -r requirements.txt
```

### Basic Usage
```bash
# Scan a single file
python main.py -f /path/to/file.exe

# Scan a directory
python main.py -d /path/to/directory

# Scan with custom thread count
python main.py -d /path/to/directory -t 10
```

### Command Line Options
```
-f, --file          Scan a single file
-d, --directory     Scan a directory recursively
-t, --threads       Number of threads (default: 5)
-e, --extensions    Custom file extensions to scan
-x, --exclude       Directories to exclude from scanning
```

## üìÅ Output Structure

The scanner creates an `output/` directory with the following log files:

```
output/
‚îú‚îÄ‚îÄ YYYY-MM-DD-infected.log          # Legacy format logs
‚îú‚îÄ‚îÄ YYYY-MM-DD-threats.json          # JSON format logs
‚îú‚îÄ‚îÄ YYYY-MM-DD-threats-structured.log # Human-readable logs
‚îî‚îÄ‚îÄ YYYY-MM-DD-threats.csv           # CSV format logs
```

## üìã Log Format Examples

### JSON Format (Machine-Readable)
```json
{
  "datetime": "2025-07-31 13:00:56",
  "scan_id": "da3b8d8f-7dd3-4cab-9be6-6fa05a5d4bb1",
  "os": "Windows",
  "hostname": "Windows-786",
  "ip": "192.168.1.100",
  "infected_file": "C:\\malware\\sample.exe",
  "sha256": "b8f21f17e79ca095fce11156b02bf6611abaf18b4bdf298ffffa42b8d7cbec57",
  "created_at": "2025-07-31 12:45:30",
  "modified_at": "2025-07-31 12:45:30"
}
```

### Structured Format (Human-Readable)
```
================================================================================
THREAT DETECTION REPORT
================================================================================
Detection Time    : 2025-07-31 13:00:56
Scan ID          : da3b8d8f-7dd3-4cab-9be6-6fa05a5d4bb1
System Info      : Windows | Windows-786 | 192.168.1.100
Infected File    : C:\malware\sample.exe
SHA256 Hash      : b8f21f17e79ca095fce11156b02bf6611abaf18b4bdf298ffffa42b8d7cbec57
File Created     : 2025-07-31 12:45:30
File Modified    : 2025-07-31 12:45:30
================================================================================
```

## üîß Configuration

### Supported File Extensions
By default, the scanner checks these file types:
```python
['.exe', '.dll', '.sys', '.doc', '.docx', '.xls', '.xlsx', 
 '.py', '.xml', '.cfg', '.txt', '.ppt', '.pptx', '.hwp', 
 '.xapk', '.jpg', '.jpeg', '.png']
```

### Excluded Directories
These directories are skipped by default:
```python
['venv', 'venv2', '.idea', 'lib']
```

## üõ†Ô∏è Advanced Usage

### Using Enhanced Logging Directly
```python
from enhanced_logging import EnhancedLogger

logger = EnhancedLogger('/path/to/output', '2025-07-31')
logger.log_threat_detection(scan_data, format_type='json')
```

### Integration with SIEM Tools

#### Splunk Integration
```bash
# Monitor JSON logs in Splunk
[monitor:///path/to/output/*-threats.json]
sourcetype = malware_scanner_json
index = security
```

#### ELK Stack Integration
```yaml
# Filebeat configuration
filebeat.inputs:
- type: log
  paths:
    - "/path/to/output/*-threats.json"
  json.keys_under_root: true
  json.add_error_key: true
```

## üìä Preview
<img src="./preview.png" alt="Malware Scanner Preview">

## ü§ù Contributing

1. Fork the repository
2. Create a feature branch (`git checkout -b feature/amazing-feature`)
3. Commit your changes (`git commit -m 'Add amazing feature'`)
4. Push to the branch (`git push origin feature/amazing-feature`)
5. Open a Pull Request

## üìù License

This project is licensed under the MIT License - see the [LICENSE](LICENSE) file for details.

## ‚≠ê Support

If this tool helps you in your security work, please consider giving it a star! Your support encourages continued development and improvements.

## üîó Links

- **Author**: [HPPAVILLIAN](https://github.com/HPPAVILLIAN/)
- **Issues**: [Report bugs or request features](https://github.com/HPPAVILLIAN/malware_scanner/issues)
- **Documentation**: [Wiki](https://github.com/HPPAVILLIAN/malware_scanner/wiki)

---

**‚ö†Ô∏è Disclaimer**: This tool is for educational and legitimate security testing purposes only. Always ensure you have proper authorization before scanning systems.

